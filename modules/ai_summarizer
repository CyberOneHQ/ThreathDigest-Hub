# ==== Module Imports ====
import openai
import logging

# ==== GPT Summarizer ====
def summarize_content(content):
    try:
        if not content.strip():
            return ""

        response = openai.ChatCompletion.create(
            model="gpt-4",
            messages=[
                {
                    "role": "system",
                    "content": (
                        "You are a cybersecurity analyst. Read the content and summarize it in 3 to 4 concise sentences. "
                        "The summary should highlight the nature of the threat or incident, impacted entities, severity, "
                        "and any relevant mitigation or response, without using bullet points."
                    )
                },
                {"role": "user", "content": content[:4000]}
            ],
            max_tokens=300,
            temperature=0.7
        )
        summary = response.choices[0].message["content"].strip()
        logging.info("Generated GPT summary.")
        return summary

    except Exception as e:
        logging.error(f"GPT summarization failed: {e}")
        return ""
